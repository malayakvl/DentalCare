import{C as _,D as R,u as m,c as F,r as z,W as $,j as e,a as x,y}from"./app-DUD9FxAe.js";import{a as B,L as H}from"./lang-Rf8_tUbV.js";import{l as M}from"./translation-CDofm1G6.js";import{I as U}from"./InputText-8GBDd7K4.js";import{I as d}from"./InputSelect-BKKZVYkM.js";import N from"./Row-Bf95W06R.js";import{I as W}from"./InputCalendar-Bvslxe5p.js";import{c as X}from"./reselect-NCCDNIWx.js";import{I as Y}from"./InputTaxSelect-WIwtnPKw.js";import{z as G}from"./transition-Dk6MwGSW.js";import"./InputLabel-Doo0KOeK.js";import"./translation-hRiGdJJJ.js";import"./selectors-BaSUzsHv.js";import"./selectors-3ONsMayW.js";import"./clsx-B-dksMZM.js";import"./floating-ui.react-CImirEtS.js";X(t=>t,t=>t);const J=t=>t.outgoinginvoices.invoiceItems,K=t=>t.outgoinginvoices.invoiceTax,P=t=>t.outgoinginvoices.showTableError,Q=_("invoice/SET_INVOICE_ITEMS"),w=_("invoice/SET_INVOICE_TAX"),Z=_("invoice/SET_INVOICE_CURRENCY"),I=_("invoice/SET_TABLE_ERRORS"),D={invoiceItems:[],invoiceTax:"",curreny:"",showTableError:!1},ee={[Q]:{next:(t,r)=>({...t,invoiceItems:r.payload})},[w]:{next:(t,r)=>({...t,invoiceTax:r.payload})},[Z]:{next:(t,r)=>({...t,curreny:r.payload})},[I]:{next:(t,r)=>({...t,showTableError:r.payload})}};R(ee,D);function ge({clinicData:t,storeData:r,statusData:T,typeData:ie,producerData:E,customerData:S,formData:c,formRowData:u=null,currencyData:C,taxData:f,className:q=""}){const k=m(B),s=new H({messages:M,locale:k}),h=F(),v=m(J),A=m(K),L=m(P),[i,g]=z.useState({invoice_number:c.invoice_number?c.invoice_number:"",invoice_date:c.invoice_date,clinic_id:t.id,store_id:c.store_id,customer_id:c.customer_id,producer_id:c.producer_id,status_id:c.status_id,type_id:c.type_id,comment:c.comment,currency_id:c.currency_id,tax_id:c.tax_id}),{processing:V,recentlySuccessful:O}=$(),o=n=>{const a=n.target.id,l=n.target.value;g(p=>({...p,[a]:l})),a==="tax_id"&&h(w(n.target.value))},b=n=>{const a=n.target.id,l=n.target.value;g(p=>({...p,[a]:l}))},j=n=>{n.preventDefault(),i.rows=v,i.invoice_date=new Date;let a=!1;v.forEach(l=>{l.product_id||(a=!0)}),a?h(I(!0)):(A.split("_"),c.id?y.post(`/invoice-outgoing/update?id=${c.id}`,{invoice_number:i.invoice_number,invoice_date:i.invoice_date,clinic_id:i.clinic_id,store_id:i.store_id,customer_id:i.customer_id,producer_id:i.producer_id,status_id:i.status_id,currency_id:i.currency_id,type_id:i.type_id,tax_id:i.tax_id,rows:v}):y.post("/invoice-outgoing/update",{invoice_number:i.invoice_number,invoice_date:i.invoice_date,clinic_id:i.clinic_id,store_id:i.store_id,customer_id:i.customer_id,producer_id:i.producer_id,status_id:i.status_id,currency_id:i.currency_id,type_id:i.type_id,tax_id:i.tax_id,rows:v}))};return e.jsxs("section",{className:q,children:[e.jsx("header",{children:e.jsxs("h2",{children:[e.jsx(x,{className:"icon-back",href:"/invoice-outgoing",children:" "}),c!=null&&c.id?s.get("invoice.title.edit"):s.get("invoice.title.create")]})}),e.jsxs("form",{onSubmit:j,className:"mt-0 space-y-4",encType:"multipart/form-data",children:[e.jsxs("div",{className:"flex flex-col md:flex-row w-full",children:[e.jsx("div",{className:"w-full md:w-1/2 px-2",children:e.jsxs("div",{className:"mb-2 flex gap-2",children:[e.jsx("div",{className:"w-1/4",children:e.jsx(U,{name:"invoice_number",values:i,dataValue:i.invoice_number,value:i.invoice_number,onChange:b,required:!0,label:s.get("invoice.number")})}),e.jsx("div",{className:"w-1/4",children:e.jsx(W,{name:"invoice_date",values:i,dataValue:i.invoice_date,value:i.invoice_date,onChange:b,required:!0,label:s.get("invoice.date")})}),e.jsx("div",{className:"w-1/4",children:e.jsx(d,{translatable:!0,name:"currency_id",className:"mb-1",values:i,value:i.currency_id,options:C,onChange:o,required:!0,label:s.get("invoice.currency")})}),e.jsx("div",{className:"w-1/4",children:e.jsx(d,{translatable:!0,name:"status_id",className:"mb-1",values:i,value:i.status_id,options:T,onChange:o,required:!0,label:s.get("invoice.status")})})]})}),e.jsxs("div",{className:"w-full md:w-1/2 px-2",children:[e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-1/4",children:e.jsx(d,{name:"producer_id",values:i,value:i.producer_id,options:E,onChange:o,required:!0,label:s.get("invoice.buyer")})}),e.jsx("div",{className:"w-1/4",children:e.jsx(d,{name:"store_id",values:i,value:i.store_id,options:r,onChange:o,required:!0,label:s.get("invoice.store")})}),e.jsx("div",{className:"w-1/4",children:e.jsx(Y,{translatable:!0,name:"tax_id",className:"mb-1 t-select",values:i,value:i.tax_id,options:f,onChange:o,required:!0,label:s.get("invoice.tax")})}),e.jsx("div",{className:"w-1/4",children:e.jsx(d,{name:"customer_id",values:i,value:i.customer_id,options:S,onChange:o,required:!0,label:s.get("invoice.person")})})]})}),e.jsx("div",{className:"mb-2"})]})]}),e.jsx("div",{className:"relative",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"pb-3",children:s.get("invoice.product")}),e.jsx("th",{className:"pb-3 w-qty",children:s.get("invoice.qty")}),e.jsx("th",{className:"pb-3 w-price",children:s.get("invoice.price")}),e.jsx("th",{className:"pb-3 w-price",children:s.get("invoice.tax")}),e.jsx("th",{className:"pb-3 w-price",children:s.get("invoice.total")}),e.jsx("th",{className:"pb-3 w-btn",children:" "}),e.jsx("th",{className:"pb-3 w-btn",children:" "})]})}),e.jsx("tbody",{children:(u==null?void 0:u.length)>0?e.jsx(N,{formRowData:u}):e.jsx(N,{formRowData:[{product_id:"",product:"",quantity:"",price:"",total:""}]})})]})}),e.jsxs("div",{children:[e.jsx("div",{style:{clear:"both"}}),e.jsx("div",{className:`mb-4 clearfix row-invoice-error ${L?"block":"hidden"}`,children:s.get("invoice.rows.error")}),e.jsxs("div",{className:"row w-full",children:[e.jsx(x,{className:"btn-back",title:s.get("invoice.back"),href:"/invoice-outgoing",children:s.get("invoice.back")}),e.jsx(x,{disabled:V,className:"btn-submit",onClick:n=>j(n),children:s.get("invoice.save")}),e.jsx(G,{show:O,enter:"transition ease-in-out",enterFrom:"opacity-0",leave:"transition ease-in-out",leaveTo:"opacity-0",children:e.jsx("p",{className:"text-sm text-gray-600",children:s.get("invoice.saved")})})]})]})]})]})}export{ge as default};
