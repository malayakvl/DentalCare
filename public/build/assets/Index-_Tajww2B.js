import{u as p,r as m,c as L,W as B,j as e,Y as v,Z as S,X as y,_ as H,$ as T,a0 as _,a1 as O}from"./app-DUD9FxAe.js";import{A as $}from"./AuthenticatedLayout-BBwQuZdH.js";import{a as V,L as I}from"./lang-Rf8_tUbV.js";import{l as K,s as W,a as X,e as Z,S as G}from"./FormPopupCreate-C30OULp5.js";import{M as J,B as x,r as Q}from"./ModalError-CMV25L4x.js";import{M as U}from"./Modal-EpUJ5xvo.js";import{h as c}from"./moment-xMAXktoI.js";import"./ApplicationLogo-fdB6LoQ_.js";import"./portal-B0qkh_OA.js";import"./transition-Dk6MwGSW.js";import"./floating-ui.react-CImirEtS.js";import"./reselect-NCCDNIWx.js";import"./PrimaryButton-DDpmqCs-.js";import"./InputText-8GBDd7K4.js";import"./InputLabel-Doo0KOeK.js";import"./InputSelect-BKKZVYkM.js";import"./translation-hRiGdJJJ.js";import"./SecondaryButton-b2dv0hg0.js";import"./index-BUYc01sp.js";import"./clsx-B-dksMZM.js";function Ee({customerData:g,formData:b,clinicData:D,cabinetData:E,eventsData:C}){const k=p(V),r=new I({messages:K,locale:k}),[h,f]=m.useState("default"),[M,u]=m.useState(!0),d=m.useRef(null),l=L(),Y=p(W),R=p(X),n=p(Z),{data:q,setData:ee,delete:te,processing:se,reset:A,errors:re,clearErrors:F}=B({title:"",doctor_id:"",patient_id:""}),j=()=>{F(),A()},P=t=>{},N=async t=>{const s=c(t.start).format("YYYY-MM-DD"),i=c(t.end).format("YYYY-MM-DD");axios.get(`/scheduler/fetchEvents?start=${s}&end=${i}`).then(o=>(l(O(o.data.items)),new Promise(w=>{n.length>0&&n.forEach(a=>{a.start=new Date(a.startDate),a.end=new Date(a.endDate)}),u(!0),setTimeout(()=>{w(n)},3e3)}))).catch(o=>{console.log("ERROR:: ",o.response.data)})};return m.useEffect(()=>{C=n,n.length>0&&n.forEach(t=>{t.start=new Date(t.startDate),t.end=new Date(t.endDate)}),u(!0)},[n]),e.jsxs($,{header:e.jsx(v,{title:"Dental Care - Scheduler"}),children:[e.jsx(v,{title:"Dental Care - Scheduler"}),e.jsx("div",{className:"py-0",children:e.jsx("div",{children:e.jsxs("div",{className:"p-4 sm:p-8 mb-8 content-data bg-content",children:[e.jsx("section",{children:e.jsx("header",{children:e.jsx("div",{className:"flex inline-flex",children:e.jsx("h2",{children:r.get("scheduler.title.list")})})})}),e.jsx(U,{show:Y,onClose:j,children:e.jsx(G,{formData:b,clinicData:D,customerData:g,cabinetData:E})}),e.jsx(J,{show:R,onClose:j,children:e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[e.jsx("span",{className:"block sm:inline",children:r.get("scheduler.error.popup")}),e.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>{l(S(!1));const t=document.getElementsByTagName("body")[0];t.style.overflow="inherit"},children:e.jsx("svg",{className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:e.jsx("path",{d:`M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0
                                            1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10
                                            8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758
                                            3.15a1.2 1.2 0 0 1 0 1.698z`})})})]})}),M&&e.jsxs(e.Fragment,{children:[e.jsx(e.Fragment,{children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsxs("span",{children:[r.get("scheduler.calendar.view"),": "]}),e.jsx(x,{color:h==="default"?"primary":"inherit",variant:h==="default"?"contained":"text",size:"small",onClick:()=>{var t,s;f("default"),(s=(t=d.current)==null?void 0:t.scheduler)==null||s.handleState("default","resourceViewMode")},children:r.get("scheduler.calendar.tabdefault")}),e.jsx(x,{color:h==="tabs"?"primary":"inherit",variant:h==="tabs"?"contained":"text",size:"small",onClick:()=>{var t,s;f("tabs"),console.log("Tabs"),(s=(t=d.current)==null?void 0:t.scheduler)==null||s.handleState("tabs","resourceViewMode")},children:r.get("scheduler.calendar.tabds")})]})}),e.jsx(Q.Scheduler,{ref:d,events:n,resources:g,hourFormat:12,resourceFields:{idField:"id",textField:"name",subTextField:"phone",avatarField:"avatar",colorField:"color"},week:{weekDays:[0,1,2,3,4,5],weekStartOn:1,startHour:9,endHour:19,step:30,cellRenderer:({height:t,start:s,onCellClick:i,...o})=>{const a=s.getHours()===8,z=a?{}:o;return e.jsx(x,{style:{height:"100%",background:a?"#eee":"transparent",cursor:a?"not-allowed":"pointer"},onClick:oe=>a?alert("Opss"):P(),disableRipple:a,...z})}},eventRenderer:({event:t,...s})=>{var i,o;return e.jsxs("div",{onMouseOver:()=>console.log(1),style:{display:"inherit",flexDirection:"column",justifyContent:"space-between",height:"100%",background:t.color,position:"relative"},...s,children:[((i=d.current)==null?void 0:i.scheduler.view)==="day"&&e.jsxs("div",{style:{height:20,fontSize:"12px"},children:[t.event_time_from," - ",t.event_time_to]}),((o=d.current)==null?void 0:o.scheduler.view)==="month"&&e.jsx("div",{style:{height:20,fontSize:"12px"},children:"Month"}),e.jsx("div",{className:"schedule-status-circle rounded-full",style:{backgroundColor:t.status_color}}),e.jsxs("div",{style:{fontSize:"12px"},children:[t.title,"  [",t.cabinet_name,"]"]}),e.jsxs("div",{style:{height:20,fontSize:"12px"},children:[r.get("scheduler.patient"),":",e.jsxs("b",{children:[" ",t.first_name," ",t.last_name]})]})]})},onEventClick:t=>{console.log("Event data",t),l(y(!0))},onCellClick:(t,s,i,o)=>{console.log(c(t).isBefore(c())),c(t).isAfter(c())?(console.log(c(t).format("HH:mm")),l(H(o)),l(T(c(t).format("YYYY-MM-DD"))),l(_(t)),l(y(!0))):l(S(!0))},getRemoteEvents:N,translations:{navigation:{month:r.get("scheduler.month"),week:r.get("scheduler.week"),day:r.get("scheduler.day"),today:r.get("scheduler.today"),agenda:r.get("scheduler.agenda")}}})]})]})})})]})}export{Ee as default};
