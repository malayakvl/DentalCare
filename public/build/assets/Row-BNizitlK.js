import{r as n,c as v,u as w,O as S,Q as q,j as e,S as C,A,v as I,B as _}from"./app-DUD9FxAe.js";import{a as F}from"./selectors-DcLeQ0hp.js";import{I as R}from"./InputSelect-BKKZVYkM.js";import"./reselect-NCCDNIWx.js";import"./InputLabel-Doo0KOeK.js";import"./translation-hRiGdJJJ.js";import"./lang-Rf8_tUbV.js";function V({formRowData:h=null,lastRow:x=null,unitData:j}){const[s,i]=n.useState(h),r=v(),[P,o]=n.useState(!1),d=w(F),[y,N]=n.useState(0),b=()=>{i([...s,{product_id:"",unit_id:"",product:"",quantity:"",maxQty:"",price:"",total:""}])},c=(a,t,l="")=>{r(C(!1));let{name:u,value:p}=a.target,m=[...s];m[t][u]=p,N(t),u==="product"?p.length>3?r(A(p)):(r(I()),o(!1)):u==="unit_id"?s[t].unit_id=a.target.value:(s[t].quantity=a.target.value,s[t].total=a.target.value?parseFloat(a.target.value)*s[t].price:0),i(m)},f=a=>{const t=[...s];t.splice(a,1),i(t)};n.useEffect(()=>{r(S(s));let a=0;s.map(t=>{a+=Number(t.total?t.total:0)}),r(q(a))},[s]);const g=a=>d.length>0?e.jsx("div",{className:"absolute autocomplete",style:{top:a*50+75+"px",width:"500px"},children:e.jsx("ul",{children:d.map(t=>e.jsxs("li",{className:"cursor-pointer py-1",onClick:()=>{o(!0),r(_()),s[a].product=t.name,s[a].product_id=t.id,s[a].quantity=1,s[a].price=t.price_per_unit>0?t.price_per_unit:t.retail_price,s[a].total=(1*(t.price_per_unit>0?t.price_per_unit:t.retail_price)).toFixed(2)},children:[t.name," ",t.producerName]}))})}):e.jsx(e.Fragment,{});return e.jsxs(e.Fragment,{children:[s.map((a,t)=>e.jsxs("tr",{children:[e.jsx("td",{className:"w-product  pb-2",children:e.jsx("div",{className:"relative",children:e.jsx("input",{name:"product",className:"input-text",type:"text",value:a.product,onChange:l=>c(l,t)})})}),e.jsx("td",{className:"w-qty pb-2 mx-auto pl-[10px]",children:e.jsx(R,{translatable:!1,name:"unit_id",className:"mb-1",values:s,value:a.unit_id,defaultValue:a.unit_id,options:j,onChange:l=>c(l,t),required:!0,label:""})}),e.jsx("td",{className:"w-qty pb-2 mx-auto",children:e.jsx("div",{className:"row flex ml-[10px]",children:e.jsx("input",{className:"input-text w-[100px] text-center",name:"qty",type:"text",value:a.quantity,onChange:l=>c(l,t)})})}),e.jsx("td",{className:"w-qty pb-2 mx-auto pl-[10px]",children:e.jsx("input",{className:"input-text price text-center",name:"price",type:"text",readOnly:!0,value:a.price,onChange:l=>c(l,t)})}),e.jsx("td",{className:"w-qty pb-2 mx-auto pl-[10px]",children:e.jsx("input",{className:"input-text price text-center",name:"total",type:"text",readOnly:!0,value:a.total,onChange:l=>c(l,t)})}),e.jsx("td",{className:"w-btn pb-2",children:s.length>1&&e.jsx("button",{onClick:()=>f(t),className:"btn-delete"})}),e.jsx("td",{className:"w-btn pb-2",children:t===s.length-1&&!x&&e.jsx("button",{onClick:()=>b(),className:"btn-plus"})})]},t)),e.jsx("tr",{children:e.jsxs("td",{colSpan:6,children:[e.jsxs("div",{className:"body hidden",children:[" ",JSON.stringify(s)," "]}),e.jsx("div",{className:"text-left",children:g(y)})]})})]})}export{V as default};
