import{u as d,c as E,r as T,W as L,j as e,a as v,n as F,o as V,y as g}from"./app-DUD9FxAe.js";import{a as z,L as W}from"./lang-Rf8_tUbV.js";import{l as $}from"./translation-CDofm1G6.js";import{I as A}from"./InputText-8GBDd7K4.js";import{I as u}from"./InputSelect-BKKZVYkM.js";import j from"./Row-B4uL5Cq3.js";import{I as B}from"./InputCalendar-Bvslxe5p.js";import{i as G,a as H,t as J}from"./selectors-3ONsMayW.js";import{z as K}from"./transition-Dk6MwGSW.js";import"./reselect-NCCDNIWx.js";import"./InputLabel-Doo0KOeK.js";import"./translation-hRiGdJJJ.js";import"./selectors-DcLeQ0hp.js";import"./clsx-B-dksMZM.js";import"./floating-ui.react-CImirEtS.js";function ce({clinicData:f,storeData:_,statusData:w,customerData:N,formData:s,formRowData:r=null,className:y=""}){const I=d(z),t=new W({messages:$,locale:I}),h=E(),a=d(G),S=d(H),C=d(J),[i,x]=T.useState({invoice_number:s.invoice_number?s.invoice_number:"",invoice_date:s.invoice_date,clinic_id:f.id,status_id:s.status_id,customer_id:s.customer_id,storefrom_id:s.storefrom_id,storeto_id:s.storeto_id,comment:s.comment,currency_id:s.currency_id}),{processing:q,recentlySuccessful:k}=L(),l=n=>{const c=n.target.id,o=n.target.value;x(m=>({...m,[c]:o})),c==="storefrom_id"&&h(F(n.target.value))},p=n=>{const c=n.target.id,o=n.target.value;x(m=>({...m,[c]:o}))},b=n=>{n.preventDefault(),i.rows=a,i.invoice_date=new Date;let c=!1;a.forEach(o=>{o.product_id||(c=!0)}),c?h(V(!0)):(S.split("_"),s.id?(console.log(i),g.post(`/invoice-change/update?id=${s.id}`,{invoice_number:i.invoice_number,invoice_date:i.invoice_date,clinic_id:i.clinic_id,storefrom_id:i.storefrom_id,storeto_id:i.storeto_id,customer_id:i.customer_id,status_id:i.status_id,rows:a})):g.post("/invoice-change/update",{invoice_number:i.invoice_number,invoice_date:i.invoice_date,clinic_id:i.clinic_id,storefrom_id:i.storefrom_id,storeto_id:i.storeto_id,customer_id:i.customer_id,status_id:i.status_id,rows:a}))};return e.jsxs("section",{className:y,children:[e.jsx("header",{children:e.jsxs("h2",{children:[e.jsx(v,{className:"icon-back",href:"/invoice-incoming",children:" "}),s!=null&&s.id?t.get("invoice.title.edit"):t.get("invoice.title.create")]})}),e.jsxs("form",{onSubmit:b,className:"mt-0 space-y-4",encType:"multipart/form-data",children:[e.jsx("div",{className:"flex flex-col md:flex-row w-full",children:e.jsx("div",{className:"flex flex-col md:flex-row w-full",children:e.jsx("div",{className:"w-full md:w-full px-2",children:e.jsxs("div",{className:"mb-2 flex gap-2",children:[e.jsx("div",{className:"w-1/4",children:e.jsx(A,{name:"invoice_number",values:i,dataValue:i.invoice_number,value:i.invoice_number,onChange:p,required:!0,label:t.get("invoice.number")})}),e.jsx("div",{className:"w-1/4",children:e.jsx(B,{name:"invoice_date",values:i,dataValue:i.invoice_date,value:i.invoice_date,onChange:p,required:!0,label:t.get("invoice.date")})}),e.jsx("div",{className:"w-1/3",children:e.jsx(u,{name:"storefrom_id",values:i,value:i.storefrom_id,options:_,onChange:l,required:!0,label:t.get("invoice.store")})}),e.jsx("div",{className:"w-1/3",children:e.jsx(u,{name:"storeto_id",values:i,value:i.storeto_id,options:_,onChange:l,required:!0,label:t.get("invoice.store")})}),e.jsx("div",{className:"w-1/3",children:e.jsx(u,{translatable:!0,name:"status_id",className:"mb-1",values:i,value:i.status_id,options:w,onChange:l,required:!0,label:t.get("invoice.status")})}),e.jsx("div",{className:"w-1/2",children:e.jsx(u,{name:"customer_id",values:i,value:i.customer_id,options:N,onChange:l,required:!0,label:t.get("invoice.person")})})]})})})}),e.jsx("div",{className:"relative",children:e.jsxs("table",{className:"w-full1",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"pb-3",children:t.get("invoice.product")}),e.jsx("th",{className:"pb-3 w-qty",children:t.get("invoice.qty")}),e.jsx("th",{className:"pb-3 w-btn",children:" "}),e.jsx("th",{className:"pb-3 w-btn",children:" "})]})}),e.jsx("tbody",{children:(r==null?void 0:r.length)>0?e.jsx(j,{formRowData:r}):e.jsx(j,{formRowData:[{product_id:"",product:"",quantity:"",price:"",total:""}]})})]})}),e.jsxs("div",{children:[e.jsx("div",{style:{clear:"both"}}),e.jsx("div",{className:`mb-4 clearfix row-invoice-error ${C?"block":"hidden"}`,children:t.get("invoice.rows.error")}),e.jsxs("div",{className:"row w-full",children:[e.jsx(v,{className:"btn-back",title:t.get("invoice.back"),href:"/invoice-incoming",children:t.get("invoice.back")}),s.status_id!=2&&e.jsx(v,{disabled:q,className:"btn-submit",onClick:n=>b(n),children:t.get("invoice.save")}),e.jsx(K,{show:k,enter:"transition ease-in-out",enterFrom:"opacity-0",leave:"transition ease-in-out",leaveTo:"opacity-0",children:e.jsx("p",{className:"text-sm text-gray-600",children:t.get("invoice.saved")})})]})]})]})]})}export{ce as default};
