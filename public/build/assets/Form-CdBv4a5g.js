import{u,c as z,r as F,W as V,j as e,a as v,z as $,o as A,y as b}from"./app-DUD9FxAe.js";import{a as W,L as B}from"./lang-Rf8_tUbV.js";import{l as G}from"./translation-CDofm1G6.js";import{I as H}from"./InputText-8GBDd7K4.js";import{I as l}from"./InputSelect-BKKZVYkM.js";import j from"./Row-BZTxjoCY.js";import{I as J}from"./InputCalendar-Bvslxe5p.js";import{i as K,a as M,t as O}from"./selectors-3ONsMayW.js";import{I as P}from"./InputTaxSelect-WIwtnPKw.js";import{z as Q}from"./transition-Dk6MwGSW.js";import"./reselect-NCCDNIWx.js";import"./InputLabel-Doo0KOeK.js";import"./translation-hRiGdJJJ.js";import"./selectors-DcLeQ0hp.js";import"./clsx-B-dksMZM.js";import"./floating-ui.react-CImirEtS.js";function ue({clinicData:g,storeData:N,statusData:w,typeData:U,producerData:y,customerData:f,formData:t,formRowData:d=null,currencyData:I,taxData:C,className:S=""}){const q=u(W),s=new B({messages:G,locale:q}),p=z(),o=u(K),T=u(M),k=u(O),[i,_]=F.useState({invoice_number:t.invoice_number?t.invoice_number:"",invoice_date:t.invoice_date,clinic_id:g.id,store_id:t.store_id,customer_id:t.customer_id,producer_id:t.producer_id,status_id:t.status_id,type_id:t.type_id,comment:t.comment,currency_id:t.currency_id,tax_id:t.tax_id}),{processing:E,recentlySuccessful:L}=V(),r=c=>{const n=c.target.id,a=c.target.value;_(m=>({...m,[n]:a})),n==="tax_id"&&p($(c.target.value))},x=c=>{const n=c.target.id,a=c.target.value;_(m=>({...m,[n]:a}))},h=c=>{c.preventDefault(),i.rows=o,i.invoice_date=new Date;let n=!1;o.forEach(a=>{a.product_id||(n=!0)}),n?p(A(!0)):(T.split("_"),t.id?(console.log(i),b.post(`/invoice-incoming/update?id=${t.id}`,{invoice_number:i.invoice_number,invoice_date:i.invoice_date,clinic_id:i.clinic_id,store_id:i.store_id,customer_id:i.customer_id,producer_id:i.producer_id,status_id:i.status_id,currency_id:i.currency_id,type_id:i.type_id,tax_id:i.tax_id,rows:o})):b.post("/invoice-incoming/update",{invoice_number:i.invoice_number,invoice_date:i.invoice_date,clinic_id:i.clinic_id,store_id:i.store_id,customer_id:i.customer_id,producer_id:i.producer_id,status_id:i.status_id,currency_id:i.currency_id,type_id:i.type_id,tax_id:i.tax_id,rows:o}))};return e.jsxs("section",{className:S,children:[e.jsx("header",{children:e.jsxs("h2",{children:[e.jsx(v,{className:"icon-back",href:"/invoice-incoming",children:" "}),t!=null&&t.id?s.get("invoice.title.edit"):s.get("invoice.title.create")]})}),e.jsxs("form",{onSubmit:h,className:"mt-0 space-y-4",encType:"multipart/form-data",children:[e.jsx("div",{className:"flex flex-col md:flex-row w-full",children:e.jsxs("div",{className:"flex flex-col md:flex-row w-full",children:[e.jsx("div",{className:"w-full md:w-1/2 px-2",children:e.jsxs("div",{className:"mb-2 flex gap-2",children:[e.jsx("div",{className:"w-1/4",children:e.jsx(H,{name:"invoice_number",values:i,dataValue:i.invoice_number,value:i.invoice_number,onChange:x,required:!0,label:s.get("invoice.number")})}),e.jsx("div",{className:"w-1/4",children:e.jsx(J,{name:"invoice_date",values:i,dataValue:i.invoice_date,value:i.invoice_date,onChange:x,required:!0,label:s.get("invoice.date")})}),e.jsx("div",{className:"w-1/4",children:e.jsx(l,{translatable:!0,name:"currency_id",className:"mb-1",values:i,value:i.currency_id,options:I,onChange:r,required:!0,label:s.get("invoice.currency")})}),e.jsx("div",{className:"w-1/4",children:e.jsx(l,{translatable:!0,name:"status_id",className:"mb-1",values:i,value:i.status_id,options:w,onChange:r,required:!0,label:s.get("invoice.status")})})]})}),e.jsx("div",{className:"w-full md:w-1/2 px-2",children:e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-1/4",children:e.jsx(l,{name:"producer_id",values:i,value:i.producer_id,options:y,onChange:r,required:!0,label:s.get("invoice.producer")})}),e.jsx("div",{className:"w-1/4",children:e.jsx(l,{name:"store_id",values:i,value:i.store_id,options:N,onChange:r,required:!0,label:s.get("invoice.store")})}),e.jsx("div",{className:"w-1/4",children:e.jsx(P,{translatable:!0,name:"tax_id",className:"mb-1 t-select",values:i,value:i.tax_id,options:C,onChange:r,required:!0,label:s.get("invoice.tax")})}),e.jsx("div",{className:"w-1/4",children:e.jsx(l,{name:"customer_id",values:i,value:i.customer_id,options:f,onChange:r,required:!0,label:s.get("invoice.person")})})]})})})]})}),e.jsx("div",{className:"relative",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"pb-3",children:s.get("invoice.product")}),e.jsx("th",{className:"pb-3 w-qty",children:s.get("invoice.qty")}),e.jsx("th",{className:"pb-3 w-price",children:s.get("invoice.price")}),e.jsx("th",{className:"pb-3 w-price",children:s.get("invoice.tax")}),e.jsx("th",{className:"pb-3 w-price",children:s.get("invoice.total")}),e.jsx("th",{className:"pb-3 w-btn",children:" "}),e.jsx("th",{className:"pb-3 w-btn",children:" "})]})}),e.jsx("tbody",{children:(d==null?void 0:d.length)>0?e.jsx(j,{formRowData:d}):e.jsx(j,{formRowData:[{product_id:"",product:"",quantity:"",price:"",total:""}]})})]})}),e.jsxs("div",{children:[e.jsx("div",{style:{clear:"both"}}),e.jsx("div",{className:`mb-4 clearfix row-invoice-error ${k?"block":"hidden"}`,children:s.get("invoice.rows.error")}),e.jsxs("div",{className:"row w-full",children:[e.jsx(v,{className:"btn-back",title:s.get("invoice.back"),href:"/invoice-incoming",children:s.get("invoice.back")}),t.status_id!=2&&e.jsx(v,{disabled:E,className:"btn-submit",onClick:c=>h(c),children:s.get("invoice.save")}),e.jsx(Q,{show:L,enter:"transition ease-in-out",enterFrom:"opacity-0",leave:"transition ease-in-out",leaveTo:"opacity-0",children:e.jsx("p",{className:"text-sm text-gray-600",children:s.get("invoice.saved")})})]})]})]})]})}export{ue as default};
