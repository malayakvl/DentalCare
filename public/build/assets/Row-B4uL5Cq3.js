import{r as o,c as w,u as y,p as v,j as s,o as S,t as C,v as A,w as I}from"./app-DUD9FxAe.js";import{s as Q}from"./selectors-DcLeQ0hp.js";import{c as F}from"./reselect-NCCDNIWx.js";F(l=>l,l=>l);const R=l=>l.changeinvoices.storeFromId;function M({formRowData:l=null,lastRow:j=null}){const[e,i]=o.useState(l),c=w(),[k,m]=o.useState(!1),d=y(Q),[f,N]=o.useState(0),b=y(R),q=()=>{i([...e,{product_id:"",producer_id:0,product:"",quantity:0,maxQty:0}])},u=(a,t,n="")=>{c(S(!1));let{name:r,value:p}=a.target,h=[...e];h[t][r]=p,N(t),r==="product"?p.length>3?c(C(p,b)):(c(A()),m(!1)):r==="plusBtn"?(e[t].quantity=e[t].quantity+1,e[t].quantity>e[t].maxQty&&(e[t].quantity=e[t].maxQty)):r==="minusBtn"?e[t].quantity=e[t].quantity>1?e[t].quantity-1:1:e[t].quantity=a.target.value,i(h)},x=a=>{const t=[...e];t.splice(a,1),i(t)};o.useEffect(()=>{c(v(e))},[e]);const g=a=>d.length>0?s.jsx("div",{className:"absolute autocomplete",style:{top:a*50+75+"px",width:"500px"},children:s.jsx("ul",{children:d.map(t=>s.jsxs("li",{className:"cursor-pointer py-1",onClick:()=>{m(!0),c(I()),e[a].product=t.name,e[a].product_id=t.id,e[a].quantity=1,e[a].maxQty=t.quantity,e[a].producer_id=t.producer_id},children:[t.name," ",t.producerName," (",t.quantity," ",t.unitName,")"]}))})}):s.jsx(s.Fragment,{});return s.jsxs(s.Fragment,{children:[e.map((a,t)=>s.jsxs("tr",{children:[s.jsx("td",{className:"w-product  pb-2",children:s.jsx("div",{className:"relative",children:s.jsx("input",{name:"product",className:"input-text",type:"text",value:a.product,onChange:n=>u(n,t)})})}),s.jsx("td",{className:"w-qty pb-2 mx-auto",children:s.jsxs("div",{className:"row flex ml-[40px]",children:[s.jsx("button",{name:"minusBtn",onClick:n=>{u(n,t,"minus")},className:"btn-qty-minus",type:"button",children:"-"}),s.jsx("input",{className:"qty text-center",name:"qty",type:"text",value:a.quantity,onChange:n=>u(n,t)}),s.jsx("button",{name:"plusBtn",onClick:n=>{u(n,t,"plus")},className:"btn-qty-plus",type:"button",children:"+"})]})}),s.jsx("td",{className:"w-btn pb-2",children:e.length>1&&s.jsx("button",{onClick:()=>x(t),className:"btn-delete"})}),s.jsx("td",{className:"w-btn pb-2",children:t===e.length-1&&!j&&s.jsx("button",{onClick:()=>q(),className:"btn-plus"})})]},t)),s.jsx("tr",{children:s.jsxs("td",{colSpan:6,children:[s.jsxs("div",{className:"body hidden",children:[" ",JSON.stringify(e)," "]}),s.jsx("div",{className:"text-left",children:g(f)})]})})]})}export{M as default};
