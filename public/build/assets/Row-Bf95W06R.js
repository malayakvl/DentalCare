import{r as l,c as C,u as j,p as F,j as e,o as E,E as I,v as y}from"./app-DUD9FxAe.js";import{u as A}from"./selectors-BaSUzsHv.js";import{a as R}from"./selectors-3ONsMayW.js";import"./reselect-NCCDNIWx.js";function _({formRowData:N=null,lastRow:f=null}){const[s,p]=l.useState(N),c=C(),[k,m]=l.useState(!1),d=j(A),[b,g]=l.useState(0),o=j(R),[h,S]=l.useState(0),q=()=>{p([...s,{product_id:"",product:"",quantity:0,price:0,tax:0,total:0}])},r=(a,t,n="")=>{c(E(!1));let{name:u,value:i}=a.target,x=[...s];x[t][u]=i,g(t),u==="product"?i.length>3?c(I(i)):(c(y()),m(!1)):u==="plusBtn"?(s[t].quantity=s[t].quantity+1,s[t].total=parseFloat(String(s[t].quantity))*parseFloat(String(s[t].price))):u==="minusBtn"&&(s[t].quantity=s[t].quantity>1?s[t].quantity-1:1,s[t].total=parseFloat(String(s[t].quantity))*parseFloat(String(s[t].price))),p(x)};l.useEffect(()=>{const a=o.split("_");s.map(t=>{t.tax_amount=a[1]?t.price*a[1]/100:0}),S(parseInt(a[1]))},[o]),l.useEffect(()=>{console.log("reaclculate nds",h)},[h]);const v=a=>{const t=[...s];t.splice(a,1),p(t)};l.useEffect(()=>{c(F(s))},[s]);const w=a=>d.length>0?e.jsx("div",{className:"absolute autocomplete",style:{top:a*50+75+"px",width:"500px"},children:e.jsx("ul",{children:d.map(t=>e.jsx("li",{className:"cursor-pointer py-1",onClick:()=>{m(!0),c(y());const n=o.split("_");s[a].product=t.name,s[a].product_id=t.id,s[a].price=t.retail_price,s[a].tax_amount=o?t.retail_price*n[1]/100:0,s[a].quantity=1,s[a].total=parseFloat(String(s[a].price))},children:t.name}))})}):e.jsx(e.Fragment,{});return e.jsxs(e.Fragment,{children:[s.map((a,t)=>e.jsxs("tr",{children:[e.jsx("td",{className:"w-product  pb-2",children:e.jsx("div",{className:"relative",children:e.jsx("input",{name:"product",className:"input-text",type:"text",value:a.product,onChange:n=>r(n,t)})})}),e.jsx("td",{className:"w-qty pb-2 mx-auto",children:e.jsxs("div",{className:"row flex ml-[40px]",children:[e.jsx("button",{name:"minusBtn",onClick:n=>{r(n,t,"minus")},className:"btn-qty-minus",type:"button",children:"-"}),e.jsx("input",{className:"qty text-center",name:"qty",type:"text",value:a.quantity,onChange:n=>r(n,t)}),e.jsx("button",{name:"plusBtn",onClick:n=>{r(n,t,"plus")},className:"btn-qty-plus",type:"button",children:"+"})]})}),e.jsx("td",{className:"w-price text-center pb-2",children:e.jsx("input",{className:"input-text price text-center",name:"price",type:"text",value:a.price,onChange:n=>r(n,t)})}),e.jsx("td",{className:"w-price text-center pb-2",children:e.jsx("input",{className:"input-text price text-center",name:"total",type:"text",value:a.tax_amount})}),e.jsx("td",{className:"w-price text-center pb-2",children:e.jsx("input",{className:"input-text price text-center",name:"total",type:"text",value:a.total})}),e.jsx("td",{className:"w-btn pb-2",children:s.length>1&&e.jsx("button",{onClick:()=>v(t),className:"btn-delete"})}),e.jsx("td",{className:"w-btn pb-2",children:t===s.length-1&&!f&&e.jsx("button",{onClick:()=>q(),className:"btn-plus"})})]},t)),e.jsx("tr",{children:e.jsxs("td",{colSpan:6,children:[e.jsxs("div",{className:"body hidden",children:[" ",JSON.stringify(s)," "]}),e.jsx("div",{className:"text-left",children:w(b)})]})})]})}export{_ as default};
